-- TABLE: EMP_EDUCATION
-- ID	NUMBER(10,0)
-- EMPLOYEE_ID	NUMBER(10,0)
-- TYPE	NVARCHAR2(100 CHAR)
-- LEVEL_OF_EDU	NCHAR(50 CHAR)
-- MAJOR	NVARCHAR2(100 CHAR)
-- PLACE	NVARCHAR2(500 CHAR)
-- GRADUATED_DATE	DATE
-- ATTACH_FILE	NVARCHAR2(100 CHAR)
-- IS_DEL	NUMBER(2,0)
-- EXPIRATION_DATE	DATE
-- EFFECTIVE_DATE	DATE
-- CERTIFICATE_NAME	NVARCHAR2(100 CHAR)
-- EMPLOYEE_CODE	NVARCHAR2(100 CHAR)
-- PRIMARY_EDUCATION	NUMBER(1,0)
-- ATTACH_NAME	VARCHAR2(1000 BYTE)
-- REC_ID	NVARCHAR2(50 CHAR)
-- DISCIPLINE_ID	NVARCHAR2(30 CHAR)
-- INSTITUTION_ID	NVARCHAR2(10 CHAR)
-- ATTACH_URL	NVARCHAR2(2000 CHAR)

-- ROW1: ATTACH_NAME = ;07-11-2023_000206_1699371059408.png | ATTACH_URL = ;https://hcm01.vstorage.vngcloud.vn/v1/AUTH_77c1e15122904b63990a9da99711590d/ERP_PORTAL/07-11-2023_000206_1699371059408.png
-- ROW2: ATTACH_NAME = 07-11-2023_626_1699370966424.png;07-11-2023_626_1699371027136.png | ATTACH_URL = https://hcm01.vstorage.vngcloud.vn/v1/AUTH_77c1e15122904b63990a9da99711590d/ERP_PORTAL/07-11-2023_626_1699370966424.png;https://hcm01.vstorage.vngcloud.vn/v1/AUTH_77c1e15122904b63990a9da99711590d/ERP_PORTAL/07-11-2023_626_1699371027136.png

-- When select data from table, create a column ATTACHMENT to display a list of href link to download file with ATTACH_NAME and ATTACH_URL

SELECT 
    edu.ID,
    edu.EMPLOYEE_ID,
    edu.TYPE,
    edu.LEVEL_OF_EDU,
    edu.MAJOR,
    edu.PLACE,
    edu.GRADUATED_DATE,
    edu.ATTACH_URL,
    edu.ATTACH_NAME,
    edu.EMPLOYEE_CODE,
    -- create a column ATTACHMENT to display a list of href link to download file with ATTACH_NAME and ATTACH_URL
    (SELECT LISTAGG('<a href="' || ATTACH_URL || '" target="_blank">' || ATTACH_NAME || '</a>', ', ') WITHIN GROUP (ORDER BY ATTACH_NAME) FROM EMP_EDUCATION WHERE ID = edu.ID) AS ATTACHMENT,
    '#' as Action
from EMP_EDUCATION edu where edu.IS_DEL = 0
